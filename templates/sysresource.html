<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <title>{% block title %}天融信网络安全仿真系统--对抗{% endblock %}</title>
  <!-- Bootstrap core CSS -->
  <link href="/statics/css/bootstrap.css" rel="stylesheet"/>
  <!-- Custom styles for this template -->
  <link href="/statics/css/navbar.css" rel="stylesheet"/>
  <link href="/statics/css/allStyle.css" rel="stylesheet"/>
  <link href="/statics/css/docsss.css" rel="stylesheet"/>
  <link href='/statics/css/ui.dynatree.css' rel='stylesheet'/>
  <link href='/statics/css/ui.dynatree.custom.css' rel='stylesheet'/>
  <link href="/statics/css/bootstrap-datetimepicker.min.css" rel="stylesheet"/>
  <style type="text/css">
    .table-hover > tbody > tr:hover > td { cursor: pointer; }
  </style>
  {% block css %}{% endblock %}
  <script src="/statics/js/jquery.js"></script>
  <script src="/statics/js/bootstrap.min.js"></script>
  <script src="/statics/js/bootstrap-datetimepicker.js"></script>
  <script src="/statics/js/bootstrap-datetimepicker.zh-CN.js"></script>
  {% block script %}
    <script src='/statics/js/jquery.custom.js' type="text/javascript"></script>
    <script src='/statics/js/jquery.cookie.js' type="text/javascript"></script>
    <script src='/statics/js/jquery.dynatree.js' type="text/javascript"></script>
  {% endblock %}
    <script type="text/javascript">
      function ajaxobj(_url, _tag, _way, _form)
      {
        var m = (typeof(_way)  ==  "undefined" ? "GET" :_way );
        var par = (typeof(_form)  ==  "undefined" ? "" :$(_form).serialize());
        var info = "";
        $.ajax({
          type:m,
          url:_url,
          data:par,
          async: false,
          error: function(request) {
          },
          success: function(data) {
            info = data;
          }
        });
        return info;
      }
      function LoadDate()
      {
        $('.form_date').datetimepicker({
          language:  'zh-CN',
          weekStart: 1,
          todayBtn:  1,
          autoclose: 1,
          todayHighlight: 1,
          startView: 2,
          minView: 2,
          forceParse: 0
        });
      }
      function savepwd()
      {
          var dev = ajaxobj("/modifypwd/", "", "post", "#userinfoform");
          if(dev == "1")
              alert("密码修改成功！");
          else
              alert("密码修改失败！");
          $('#myModal1').modal('hide');
      }
      function userpwd()
      {
          $('#myModal1').modal('show');
      }
    </script>
</head>
<body style="width:100%;height:100%; background-color:#E8EFF9; background:-webkit-linear-gradient(top, #563D7C, #FFFFFF);">
  <form method="post" formaction="/clogout/" >
  <div id="userinfo" class="topsecAbout">
    当前用户:
    <a herf="#">{{ uname }}</a>
    &nbsp;
      <button type="button" class="btn btn-success"  button  data-target="#About" title="关于"  data-toggle="modal"><span class="glyphicon glyphicon-question-sign"></span></button>
      <button type="submit" class="btn btn-success" formaction="/clogout/" title="退出" ><span class="glyphicon glyphicon-log-out"></span></button>
  </div>
  </form>
  <div class="container" style="width:100%;height:100%;">
    <!-- Static navbar -->
    <div class="navbar navbar-inverse">
      <div class="navbar-header">
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand">TopADP</a>
      </div>
      <div class="navbar-collapse collapse">
        <ul class="nav navbar-nav ">
          <li>
            <a  onclick="" href="/hacking/" >在线夺旗</a>
          </li>
          <li>
            <a  onclick="" href="/hackingorder/">夺旗排名</a>
          </li>
          <li>
            <a  onclick="" href="/sysresource/" style="color:#ffffff;">系统资源</a>
          </li>
          <li>
            <a  onclick="" href="/groupstate/">团队信息</a>
          </li>
          <li>
            <a onclick="userpwd()" href="#">修改密码</a>
          </li>
        </ul>
      </div>
    </div>
      <div id="HomeContent" style="width:100%;height:100%;">
        {% block content %}
        <div class="panel panel-default self_top" style="height:100%; margin-top:0px;">
          <div class="panel-heading">系统资源</div>
          <div class="panel-body" style="height:100%;">
            <div id="tree" style="text-align:left; vertical-align:top;">
              <table  id="lstea" class="table table-striped topsec_tabletop table-hover" data-selid="0" >
                <tr>        
                  <th>序号</th>
                  <th>资源名称</th>
                  <th>用途</th>
                  <th>大小</th>
                  <th>下载</th>
                </tr>
                <tr >
                  <td>1</td>
                  <td>asp木马</td>
                  <td>
                     <span>获取服务器信息，进行攻击</span>
                  </td>
                  <td>
                    <span>21k</span>
                  </td>
                  <td>
                    <a href="#">下载</a>
                  </td>
                </tr>
                <tr >
                  <td>2</td>
                  <td>asp木马</td>
                  <td>
                     <span>获取服务器信息，进行攻击</span>
                  </td>
                  <td>
                    <span>21k</span>
                  </td>
                  <td>
                    <a href="#">下载</a>
                  </td>
                </tr>
                <tr >
                  <td>3</td>
                  <td>asp木马</td>
                  <td>
                     <span>获取服务器信息，进行攻击</span>
                  </td>
                  <td>
                    <span>21k</span>
                  </td>
                  <td>
                    <a href="#">下载</a>
                  </td>
                </tr>
                <tr >
                  <td>4</td>
                  <td>asp木马</td>
                  <td>
                     <span>获取服务器信息，进行攻击</span>
                  </td>
                  <td>
                    <span>21k</span>
                  </td>
                  <td>
                    <a href="#">下载</a>
                  </td>
                </tr>
                <tr >
                  <td>5</td>
                  <td>asp木马</td>
                  <td>
                     <span>获取服务器信息，进行攻击</span>
                  </td>
                  <td>
                    <span>21k</span>
                  </td>
                  <td>
                    <a href="#">下载</a>
                  </td>
                </tr>
                <tr >
                  <td>6</td>
                  <td>asp木马</td>
                  <td>
                     <span>获取服务器信息，进行攻击</span>
                  </td>
                  <td>
                    <span>21k</span>
                  </td>
                  <td>
                    <a href="#">下载</a>
                  </td>
                </tr>
                <tr >
                  <td>7</td>
                  <td>asp木马</td>
                  <td>
                     <span>获取服务器信息，进行攻击</span>
                  </td>
                  <td>
                    <span>21k</span>
                  </td>
                  <td>
                    <a href="#">下载</a>
                  </td>
                </tr>
                <tr >
                  <td>8</td>
                  <td>asp木马</td>
                  <td>
                     <span>获取服务器信息，进行攻击</span>
                  </td>
                  <td>
                    <span>21k</span>
                  </td>
                  <td>
                    <a href="#">下载</a>
                  </td>
                </tr>
                <tr >
                  <td>9</td>
                  <td>asp木马</td>
                  <td>
                     <span>获取服务器信息，进行攻击</span>
                  </td>
                  <td>
                    <span>21k</span>
                  </td>
                  <td>
                    <a href="#">下载</a>
                  </td>
                </tr>
                <tr >
                  <td>10</td>
                  <td>asp木马</td>
                  <td>
                     <span>获取服务器信息，进行攻击</span>
                  </td>
                  <td>
                    <span>21k</span>
                  </td>
                  <td>
                    <a href="#">下载</a>
                  </td>
                </tr>
              <tr>
                <td colspan="8">
                    <div class="flickr">
                        <span>
                            <span class="current">1
                            </span>
                            <a href="#" title="第2页">2</a>
                        </span>
                        <a href="#">下一页</a>
                    </div>
                </td>
              </tr>
              </table>
            </div>
          </div>
        </div>
        {% endblock %}
      </div>
  </div>
  <!-- Bootstrap core JavaScript
    ================================================== -->
  <!-- Placed at the end of the document so the pages load faster -->
  <form id="userinfoform" action="/modifypwd/" method='post'>
  {% csrf_token %}
  <div class="modal fade" id="myModal1" tabindex="-1" role="dialog" aria-labelledby="myModalLabel1" aria-hidden="true" >
    <div class="modal-dialog">
      <div class="modal-content" style="width:600px; padding-top:5px;">
        <div class="modal-header" style="background-color: #FFFFFF">
          <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
          <h3 id="myModalLabel1">修改密码</h3>
        </div>
        <div>
          <table class="table topsec_tabletop">
            <tr>
              <td style="width:100px; vertical-align:middle; text-align:right;"><font color="#FF0000">*</font>原密码：</td>
              <td>
                <input id='spwd' name='spwd' type='password' required="required" class="form-control topself_input"/>
              </td>
            </tr>
            <tr>
              <td style="width:100px; vertical-align:middle; text-align:right;"><font color="#FF0000">*</font>新密码：</td>
              <td>
                <input id='npwd' name='npwd' type='password' class="form-control topself_input"/>
              </td>
            </tr>
            <tr>
              <td style="width:100px; vertical-align:middle; text-align:right;"><font color="#FF0000">*</font>重&nbsp;&nbsp;&nbsp;&nbsp;复：</td>
              <td>
                <input id='repwd' name='repwd' type='password' class="form-control topself_input"/>
              </td>
            </tr>
          </table>
          <div class="modal-footer">
          <button class="btn btn-default" data-dismiss="modal" type="button">关闭</button>
          <button class="btn btn-primary" type="button" onclick="savepwd()">保存</button>
          </div>
        </div>
      </div>
    </div>
  </div>
</form>
<form>
  {% csrf_token %}
 <div class="modal fade" id="About" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
     <div class="modal-dialog">
      <div class="modal-content" style="width:600px; padding-top:5px;">
        <div class="modal-header" style="background-color: #FFFFFF">
          <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
          <h3 id="myModalLabel">关于</h3>
        </div>
        <div>
         <table id='cladeptdetail' style="font-size:16px; vertical-align:middle; position:relative; top:0px; left:100px;">
                                                      <tr>
                                                        <td style="height:40px; text-align:left; width:30%;">
                                                            <p>发行厂商:</p>
                                                        </td>
                                                        <td style="height:40px; text-align:left;width:70%; padding-left:30px;">
                                                        <p><strong>北京天融信公司</strong></p>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td style="height:40px; text-align:left; width:30%;">
                                                            <p>产品名称:</p>
                                                        </td>
                                                        <td style="height:40px; text-align:left;width:70%; padding-left:30px;">
                                                        <p><strong>天融信网络安全仿真系统</strong></p>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td style="height:40px; text-align:left; width:30%;">
                                                            <p>产品名简称:</p>
                                                        </td>
                                                        <td style="height:40px; text-align:left;width:70%; padding-left:30px;">
                                                        <p><strong>TopADP</strong></p>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td style="height:40px; text-align:left; width:30%;">
                                                            <p>版本号:</p>
                                                        </td>
                                                        <td style="height:40px; text-align:left;width:70%; padding-left:30px;">
                                                        <p><strong>v3001 DEBUG</strong></p>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td style="height:40px; text-align:left; width:30%;">
                                                            <p>版权:</p>
                                                        </td>
                                                        <td style="height:40px; text-align:left;width:70%; padding-left:30px;">
                                                        <p><strong>(C) 2014 Topsec</strong></p>
                                                        </td>
                                                    </tr>
                      </table>
          <div class="modal-footer">
          <button class="btn btn-default" data-dismiss="modal" type="button" title='关闭'><span class="glyphicon glyphicon-remove-circle"></span></button>
          </div>
        </div>
      </div>
    </div>
  </div>
</form>
<form id="information" action="/selcourse/" method='post'>
  <input id='expid' name='expid' type='hidden' value='0'/>
  <input id='courname' name='courname' type='hidden' value='0'/>
  <input id='curexp' name='curexp' type='hidden' value='0'/>
  <input id='curvms' name='curvms' type='hidden'  value='0'/>
</form>
<script type="text/javascript">
    function open_vnc(fscreen, vmid) 
    {
        var preid = vmid;
        var url = '/console/' + preid + '/vm?token=' + preid;
        if(fscreen)
          window.open(url,'','width=850,height=485');
        else
          document.getElementById("syssframe").src = url;
    }
</script>
<script type="text/javascript">
$(function(){
        var cour=document.getElementById("coursename");
        var course = ajaxobj("/coursecheck/", "", "get", "");
        var jsondata = $.parseJSON(course);
        var coursename=jsondata.coursename;
         //alert(coursename);
        //$('#myModal2').modal('show');
        timedCount();
});

function startBench()
{
    var client = ajaxobj("/startBench/", "", "post", "#information");
    var json = $.parseJSON(client);
    var clientid = json.clientid;
    var result = json.result;

    if(result == 0 && clientid != 0)
    {
        open_vnc(false, clientid);
        $("#curvms").val(clientid);
        $("#btnstopexp").removeClass('disabled');
        $("#btnmaxscreen").removeClass('disabled');
        $("#btnstartexp").addClass('disabled');
    }
    else if (result == 2)
        alert("系统资源无法满足当前请求，请联系管理员！");
    else if(result == 1)
        alert("请求失败，请联系管理员！");
}
function stopBench()
{
    var client = ajaxobj("/stopBench/", "", "post", "#information");
    var json = $.parseJSON(client);
    var clientid = json.clientid;
    $("#curvms").val("0");
    document.getElementById("syssframe").src = "";
    $("#btnstartexp").removeClass('disabled');
    $("#btnstopexp").addClass('disabled');
    $("#btnmaxscreen").addClass('disabled');
}
function fullscreen()
{
    var clientid = $("#curvms").val();
    open_vnc(true, clientid);
    //var client = ajaxobj("/fullscreen/", "", "post", "#information");
}
function timedCount()
 {
    var client = ajaxobj("/clientinfor/", "", "post", "#information");
    var json = $.parseJSON(client);
    var clientid = json.clientid;
    var t=setTimeout("timedCount()",60000);
 }
</script>
</body>
</html>